# 數位音樂廳前端故障排除指南

## 1. 前端無法獲取後端音樂會訊息

### 症狀
- 前端首頁或音樂會列表頁面顯示「無法載入音樂會資料」或空列表
- 控制台出現 API 相關錯誤訊息

### 可能原因與解決方案

#### 1.1 後端服務未運行或端口錯誤
- **檢查:** 後端服務應在端口 8080 運行
- **解決方案:** 啟動後端服務，或檢查端口設定

```bash
# 檢查後端連接
./test-api-connection.sh
```

#### 1.2 API URL 配置錯誤
- **檢查:** `.env.development` 中的 REACT_APP_API_URL 設定
- **解決方案:** 確保設為 `http://localhost:8080`

#### 1.3 資料庫中無資料
- **問題:** 管理後台 (端口 3001) 創建的資料未同步至 H2 資料庫
- **解決方案:** 
  - 確認管理後台創建資料的流程是否完整
  - 檢查後端日誌尋找可能的同步錯誤
  - 查看 H2 資料庫內容確認資料是否存在

## 2. 路徑處理相關問題

### 症狀
- API 請求出現 404 錯誤
- 控制台顯示路徑相關錯誤

### 可能原因與解決方案

#### 2.1 API 路徑前綴重複
- **問題:** 路徑可能被添加了多個 `/api` 前綴
- **解決方案:** 使用修正後的 `validateApiPath` 函數，避免重複添加前綴

#### 2.2 錯誤的 API 路徑格式
- **檢查:** 確保所有服務文件中使用正確的 API 路徑
- **解決方案:** 統一使用 `/api/concerts` 等標準路徑格式

## 3. 環境切換與配置

### 3.1 前端重啟指南

如需重啟前端服務：

```bash
# 停止當前運行的服務
npx kill-port 3000

# 重新啟動服務
npm start
```

### 3.2 修改配置後的操作

當修改環境配置或依賴後：

1. 停止當前運行的服務
2. 清除瀏覽器快取 (使用 Ctrl+Shift+R 或 Cmd+Shift+R)
3. 重新啟動服務

## 4. 調試工具與技巧

### 4.1 API 連接測試

使用提供的測試腳本：
```bash
chmod +x test-api-connection.sh
./test-api-connection.sh
```

### 4.2 瀏覽器開發工具

- 使用 Network 標籤檢查 API 請求
- 查看 Console 中的錯誤和警告訊息
- 使用 Application > Storage 清除快取和本地存儲

### 4.3 控制台日誌級別

前端已配置詳細的日誌記錄，可在瀏覽器控制台查看以下信息：
- API 請求路徑和參數
- 回應狀態和數據
- 錯誤訊息和堆疊跟踪

## 5. 常見錯誤訊息解析

### 5.1 「無法載入音樂會資料」
- **原因:** 後端返回了空數據或請求失敗
- **解決方案:** 確認後端資料庫中是否有資料，以及管理後台創建的資料是否正確同步

### 5.2 「Backend request failed with status 401」
- **原因:** API 請求需要身份驗證
- **解決方案:** 檢查是否已正確登入，或確認是否使用了需要授權的 API 端點

### 5.3 「ECONNREFUSED」錯誤
- **原因:** 無法連接到後端服務
- **解決方案:** 確認後端服務是否運行，並檢查端口設定

## 6. 測試前的檢查清單

在測試前端功能之前，請確認：

1. 後端服務 (8080) 正常運行
2. H2 資料庫中有必要的資料
3. 前端環境變量配置正確
4. 已清除瀏覽器快取
5. 沒有控制台錯誤

## 7. 技術支援

如遇到無法解決的問題，請提供以下信息：

1. 控制台完整錯誤日誌
2. 瀏覽器網絡請求詳情 (Network 標籤截圖)
3. 使用測試腳本的輸出結果
4. 後端服務狀態和相關日誌