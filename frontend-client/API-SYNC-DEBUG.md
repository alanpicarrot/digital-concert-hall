# 數位音樂廳前後端同步問題診斷指南

## 問題描述

我們遇到的主要問題是：**管理後台 (3001) 創建的音樂會資料（包括「台北爵士音樂節」）無法在前端 (3000) 顯示**。

這是因為管理後台創建的資料未正確寫入到由後端 (8080) 控制的 H2 資料庫中。

## 技術架構

系統目前有三個主要元件：

1. **前端客戶端** - 運行在端口 3000
2. **管理後台** - 運行在端口 3001
3. **後端服務** - 運行在端口 8080，控制 H2 資料庫

## 問題診斷步驟

### 1. 檢查前端 API 連接

使用提供的測試腳本確認前端能否正確連接後端 API：

```bash
chmod +x test-api-connection.sh
./test-api-connection.sh
```

這個腳本會檢查後端服務是否運行，並測試 `/api/concerts` 端點是否返回有效的數據。如果返回空數組，表示後端資料庫中沒有音樂會數據。

### 2. 檢查管理後台操作

管理後台問題可能包括：

- 創建的資料沒有正確提交
- 提交的資料沒有被後端接收
- 後端接收到資料但未成功寫入 H2 資料庫

### 3. 檢查後端日誌

查看後端服務的日誌，找出可能的錯誤：

- API 請求是否被後端接收
- 數據處理過程中是否有錯誤
- 資料庫操作是否成功

## 解決方案

### 1. 即時解決方案

目前前端已經移除了所有模擬數據，並改為顯示友好的錯誤信息，提示用戶後端資料庫中無數據。這樣可以避免假數據帶來的干擾，並更容易發現問題。

### 2. 後端同步問題修復

要解決管理後台與後端資料庫的同步問題，可以嘗試以下方案：

1. **檢查管理後台 API 調用**
   - 確認管理後台的 API 請求是否正確發送到後端服務
   - 檢查請求格式、標頭和授權是否正確

2. **檢查後端 API 處理**
   - 確認後端正確接收和處理來自管理後台的請求
   - 檢查數據驗證和處理邏輯是否有錯誤

3. **檢查 H2 資料庫連接**
   - 確認後端服務能夠成功連接和寫入 H2 資料庫
   - 檢查資料庫架構是否與預期一致

## 注意事項

1. **避免使用模擬數據**
   - 模擬數據會干擾測試，使問題難以發現
   - 我們已經移除了所有模擬數據，以便更清晰地看到實際問題

2. **保持日誌記錄**
   - 前端和後端都應記錄詳細的日誌，以便排查問題
   - 特別關注 API 請求和回應的詳細信息

3. **增加錯誤處理**
   - 確保前端顯示清晰的錯誤信息，幫助用戶理解問題
   - 後端應返回有意義的錯誤代碼和描述

## 相關 API 端點

- **獲取所有音樂會**: `/api/concerts`
- **獲取特定音樂會**: `/api/concerts/{id}`
- **獲取即將上演的音樂會**: `/api/concerts/upcoming`
- **獲取過去的音樂會**: `/api/concerts/past`

確保管理後台使用正確的端點來創建和更新音樂會數據。