# 數位音樂廳管理後台前端開發指南

## 系統概述

數位音樂廳管理後台前端是基於 React 開發的 Web 應用，主要用於管理數位音樂廳的各種資源，包括音樂會、場次、票種和票券。系統使用 React Router 進行路由管理，使用 JWT 進行用戶身份驗證。

## 路由結構

系統的路由結構已根據要求進行了優化，每個功能頁面都有自己獨立的路徑：

- `/` - 主儀表板頁面
- `/concerts` - 音樂會管理頁面
- `/performances` - 演出場次管理頁面
- `/ticket-types` - 票種管理頁面
- `/tickets` - 票券管理頁面
- `/users` - 用戶管理頁面
- `/auth/login` - 登入頁面
- `/auth/register-admin` - 管理員註冊頁面

## 啟動與部署

1. **啟動開發環境**：
   ```bash
   cd /Users/alanp/digital-concert-hall/frontend-admin
   ./restart.sh
   ```

2. **訪問管理後台**：
   在瀏覽器中訪問 http://localhost:3001

## 登入與認證

1. **測試帳號**：
   - 用戶名：admin
   - 密碼：admin

2. **JWT 存儲**：
   - 登入成功後，JWT 令牌會保存在 localStorage 中
   - 系統會自動在每個 API 請求的頭部添加令牌

## 功能模塊說明

### 1. 音樂會管理

音樂會管理模塊用於創建和管理音樂會信息。主要功能包括：

- 查看所有音樂會列表
- 創建新音樂會，設置標題、描述、演出時間等信息
- 編輯現有音樂會的詳情
- 刪除不需要的音樂會
- 管理音樂會的狀態（活躍、非活躍、即將上演等）

### 2. 場次管理

場次管理模塊用於為音樂會創建不同的演出場次。主要功能包括：

- 查看所有場次或按音樂會篩選場次
- 創建新場次，設置開始時間、結束時間、場地等信息
- 編輯現有場次的詳情
- 刪除場次
- 更新場次狀態（已排期、進行中、已完成等）

### 3. 票種管理

票種管理模塊用於定義不同類型的票券及其價格。主要功能包括：

- 查看所有票種列表
- 創建新票種，設置名稱、描述、價格等信息
- 編輯現有票種的詳情
- 刪除不需要的票種

### 4. 票券管理

票券管理模塊用於管理特定場次的票券庫存。主要功能包括：

- 查看所有票券或按場次篩選票券
- 創建新票券，關聯到特定場次和票種，設置總數量和可用數量
- 編輯票券詳情
- 刪除票券
- 更新票券庫存

## 開發指南

### 1. 組件結構

管理後台前端使用以下組件結構：

- `layouts/AdminLayout.jsx` - 管理頁面的主佈局組件
- `layouts/AuthLayout.jsx` - 認證頁面的佈局組件
- `pages/*.jsx` - 各個功能頁面
- `components/ui/` - 共用 UI 組件
- `contexts/` - React 上下文，用於狀態管理
- `utils/` - 工具函數

### 2. API 集成

前端與後端 API 的集成方式：

- 使用 axios 發送 HTTP 請求
- API 基礎 URL 配置在 `src/api/config.js` 中
- 所有 API 請求都會自動添加授權頭部
- 使用 `.env` 文件管理不同環境的配置

### 3. 認證流程

用戶認證的實現流程：

1. 用戶在登入頁面輸入憑證
2. 前端發送請求到 `/api/auth/signin` 端點
3. 成功後接收 JWT 令牌，保存到 localStorage
4. 使用 AuthContext 在應用中共享認證狀態
5. 受保護的路由組件會檢查用戶是否已認證

### 4. 除錯技巧

開發過程中的常用除錯技巧：

- 使用瀏覽器開發工具檢查網絡請求
- 監控 React 的 useState 和 useEffect 生命週期
- 檢查 localStorage 中的令牌是否正確
- 使用 console.log 追蹤組件渲染和狀態變化

## 擴展與優化建議

1. **效能優化**：
   - 實現數據緩存，減少不必要的 API 請求
   - 使用 React.memo 和 useCallback 優化組件渲染
   - 實現虛擬列表或分頁加載，處理大量數據

2. **用戶體驗優化**：
   - 添加更多的數據視覺化圖表
   - 實現拖放界面，例如拖動排序音樂會或場次
   - 添加批量操作功能，如批量創建票券

3. **功能擴展**：
   - 添加用戶活動日誌，記錄管理操作
   - 實現基於角色的權限控制，區分不同權限的管理員
   - 添加報表和數據分析功能
   - 整合座位圖編輯器，實現可視化的票券分配

## 常見問題與解決方案

1. **登入失敗**：
   - 問題：無法登入管理後台
   - 解決方案：
     - 確認後端服務正在運行
     - 檢查開發者工具中的網絡請求，查看具體錯誤
     - 嘗試使用測試管理員帳號 (admin/admin)
     - 確認 API 基礎 URL 配置是否正確

2. **CORS 錯誤**：
   - 問題：API 請求收到 CORS 相關錯誤
   - 解決方案：
     - 確認後端 CORS 配置包含前端的 URL
     - 檢查請求是否包含適當的 credentials 設置
     - 確認請求頭部格式是否正確

3. **頁面空白或加載失敗**：
   - 問題：特定頁面顯示空白或加載錯誤
   - 解決方案：
     - 查看開發者工具的控制台錯誤訊息
     - 檢查路由配置是否正確
     - 確認該頁面需要的 API 端點是否正常運作
